\documentclass[a4paper, 12pt]{article}
\renewcommand{\baselinestretch}{1.3} % 1.5 linespacing
%\usepackage[textwidth=16cm,textheight=24cm]{geometry}
\usepackage[a4paper,  margin=2cm]{geometry}
\usepackage{amsmath,amssymb,gensymb}
\usepackage[dvipsnames]{xcolor} % variety of colour defenitions
\usepackage{graphicx}
\usepackage {wrapfig} %text to wrap around a figure
\usepackage[font=small]{caption}
\usepackage[font = small, margin = 1cm]{subcaption}
%\usepackage{caption}
% figures
\usepackage[titletoc]{appendix}
%\usepackage[toc,page]{appendix}
\usepackage{booktabs} %tables?
\usepackage{cleveref} %clever referecing use \cref{}
\crefname{appsec}{Appendix}{Appendices}
\usepackage{floatrow}
\newfloatcommand{capbtabbox}{table}[][\FBwidth]
\usepackage{listings} % typesetting code
\usepackage{multirow} %merge rows
\usepackage{array} % to left align bullets
\usepackage{enumitem} %
\usepackage{placeins}%to use \FloatBarrier command to prevent floats appearing beyond a certain point
\crefname{appsec}{Appendix}{Appendices}
\usepackage{multicol} % equations  side by side
\usepackage{hyperref} % hyperlinks
\usepackage{tikz}
\usetikzlibrary{shapes, arrows} % iscoceles triangle
\usetikzlibrary{decorations.markings}
\usepackage{pgfplots} % draw algebraic graphs
\usepackage[T1]{fontenc}
\usepackage{stix}
\usepackage{multicol}

%\newcommand{\HRule}{\rule{\linewidth}{0.1mm}} 

\graphicspath{{/home/rajiv/IIB/year4project/report/figures/}}
\DeclareGraphicsExtensions{.png,.jpg,.PNG,.jpeg}

\begin{document}

\begin{titlepage}
 \vspace*{\fill}
	\begin{center}
		{\Large Fourth Year Project Report} \vspace{0.25cm}
		\rule{\textwidth}{.1pt} \\[0.25cm]
		{\Huge Relay Feedback Models of Biologial Oscillators}\\%[0.5cm]
		\vspace{0.25cm} 
		\rule{\textwidth}{.1pt} \\[0.5cm]
		\Large{
	Rajiv Kurien\\Queens' College\\2015-2016
		}
	\end{center}
 \vspace*{\fill}
\end{titlepage}
\section*{Technical Abstract}

\hspace{0.5cm} Biological behaviours are complex, rich and varied. Oscillations in biology are diverse and models replicating them are often high dimensional and nonlinear. These models quickly get difficult to analyse and do not have a generalised theory (except two dimensional systems) to predict existence of oscillations, stability and time periods. However, the theory of relay feedback systems, a very particular type of nonlinear feedback, used classically in automatic control, has analytical solutions to these questions. 

The aim of this project was to elucidate how useful the theory of relay feedback systems would be to analysing biological oscillations. As a first step, the basic model of relay feedback was applied to two classical biological models --- the Goodwin oscillator model for genetic oscillations and the FitzHugh-Nagumo model for action potentials. Relay feedback was able to simulate oscillations in these models, reflecting upon how biological oscillations often incorporate digital and analogue dynamics. 

As a second step, the potential of nested relay feedback to model complex oscillations was investigated. A normal form model of neuronal bursting was dissected as two interconnected relay feedback systems. The Hindmarsh-Rose model of neuronal bursting was then shown to have the same structure as the normal form model, conceding it to be modelled by relay feedback. 

The project revealed how relay feedback provides an appealing modelling framework for the analysis of quantitative models of biological oscillations. It highlights how biological models can be viewed as an interconnection of analogue (L.T.I) and digitial (relay) logic. Due to the theory of relay feedback oscillations being tractable in high dimensions, it provides a way to analysing high order biological models and is amenable to robustness and sensitivy analysis. 

\newpage
\tableofcontents
\newpage
\section{Introduction}
Oscillations are an integral component in the world around us. Biochemical and biophysical rhythms are ubiquitous charactereristics of living organisms, from rapid oscillations of membrane potential in nerve cells to slow cycles of ovulation in mammals \cite{fall}. Understanding the molecular and cellular mechanisms responsible for oscillations is crucial for unravelling the dynamics of life\cite{goldbeter1}. Fundamentally, oscillations are due to feedback, and classical control has usually been applied to reduce these oscillations. With the pursuit of understanding biological oscillations, feedback models have been explored to understand how to generate different types of oscillations. Such research aims to yield a better understanding of how biology works, giving us tools to engineer biology to suit our needs. 

Several models of biological oscillations display logic. Gene regulatory models incorporate a gene turning on or off. Neuronal models are excitatory, displaying oscillations when a threshold is exceeded. Such biological models of oscillations inherently combine analogue and digital signals. They may have a large number of parameters that require tuning in order to produce oscillations and pose difficulties in extracting useful information about the effect of these parameters on existence of oscillations and their frequency. Figure \ref{parameter_search} shows how for a particular three variable dynamical system, changing two parameters reveals a rich repertoire of oscillatory behaviours. A method of addressing models of oscillations described in \cite{goldbeter1}, simply amounts to simulating the system around the parameter space that is available or in a physiological range. For high dimensional systems, a parameter search approach is computationally expensive. Furthermore, this does not easily predict the frequency of oscillations.  

\begin{figure}[h!]
\includegraphics[width=0.6\textwidth]{parameter_space}
\caption{Different domains of dynamic behaviour in the parameter space $v-k_s$ for a three variable multiply regulated biochemical system. Source \cite{goldbeter2}.}
\label{parameter_search}
\end{figure}

Another method of tackling this issue is to model oscillations as adaptation around a static nonlinearity. This approach links biological oscillation to a methodology developed in classical control --- relay feedback systems, which gives us tools to analyse oscillations.

Relay feedback consists of a plant connected via negative feedback to a static hysteretic non-linearity called a relay. Relay feedback is most popularly used in automatic tuning of PID controllers. It is one of the simplest and most robust auto-tuning techniques for process controllers and has been successfully applied to industry for more than 15 years \cite{hang}. Oscillations in simple relay feedback systems have been well understood and have analytical results even for high dimensional systems. 

Consequently, this raises the question: Are relay feedback models appropriate to analyse biologial oscillations? 
 
This project starts to address this question, and the report is structured as follows. In section \ref{Sec:theory}, some of the analytical results for oscillations in relay feedback systems from \cite{astrom1995} is presented. Section \ref{Sec:continous oscillations} uses a simple relay feedback system to model continous oscillations in the Goodwin and FitzHugh-Nagumo models. Finally, section \ref{Sec:nested oscillations} investigates using two coupled relay feedback systems to model a complex oscillation --- bursting, and consequently the famous Hindmarsh-Rose model for neuronal bursting.   

\section{Theory}\label{Sec:theory}
A relay is a particular type of nonlinearity that has only two output values, a high or a low value, dependent on the input. Figure \ref{relay_element} shows a symmetric relay element that satisfies the input ($e$) and output ($u$) relationship:
\begin{equation}
	u(t)=\begin{cases}
	               d \text{ if } e > \epsilon \text{ or } (e >-\epsilon \text{ and } u(t-) = d)\\
	                -d \text{ if } e < -\epsilon \text{ or } (e < \epsilon \text{ and } u(t-) = -d)\\
	              
	            \end{cases}
	            \label{eq:symmetric_relay_equation}
\end{equation}


\begin{figure}[h!]
\RawFloats
\centering
\color{black}
\begin{minipage}[b]{0.25\textwidth}
 \tikzstyle arrowstyle=[scale=1]
  \tikzstyle directed=[postaction={decorate,decoration={markings,
      mark=at position .9 with {\arrow[arrowstyle]{stealth}}}, mark = at position .9 with {\arrow[arrowstyle]{stealth}}}]
  \begin{center}
  \begin{tikzpicture}[scale = 0.6]
    \draw [->, very thick] (-3,0)  node (xaxis_right){} -- (3, 0) node (xaxis_left) [below] {  $e$};
    \draw [->, very thick] (0,-3)  node (yaxis_bottom){} -- (0, 3) node (yaxis_top) [right] { $u$};
    \draw [directed, thick, blue] (3,2) node(relay_top_right){} --(-1,2) node (relay_top_left){};
    \draw[directed, thick, blue] (-3,-2) node(relay_bottom_left){}--(1,-2) node (relay_bottom_right){};
    \draw[directed, thick, blue] (-1,2) node{} -- (-1,-2) node {};
    \draw[directed, thick, blue] (1,-2) node{} -- (1,2) node {};

    \draw (1,0) node [below right]{ $\epsilon$}; %label
    \draw (-1,0) node [below left]{ $-\epsilon$}; %label
    \draw (0,2) node [above left]{ $d$}; %label
    \draw (0,-2) node [below left]{ $-d$}; %label
	\end{tikzpicture}
	\end{center}
		 \captionof{figure}{Relay element}%
		 \label{relay_element}%
	\end{minipage}%
\qquad%
	\begin{minipage}[b]{0.5\textwidth}
		\tikzstyle{block} = [draw, fill=white, rectangle, 
    minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw, fill=white, circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

% The block diagram code is probably more verbose than necessary
\begin{center}
\resizebox{7cm}{!}{%
\begin{tikzpicture}[auto, node distance=2cm,>=latex]
    % We start by placing the blocks
    \node [input, name=input] {};
    \node [sum, right of=input] (sum) {};
    \node [block, right of=sum] (relay) {Relay};
    \node [block, right of=relay, node distance = 3.5cm] (plant) {Plant};
    % We draw an edge between the controller and system block to 
    % calculate the coordinate u. We need it to place the measurement block. 
    \draw [->] (relay) -- node[name=u] {$u$} (plant);
    \node [output, right of=plant] (output) {};
    \node [output, below of=u] (measurements) {Measurements};

    % Once the nodes are placed, connecting them is easy. 
    \draw [draw,->] (input) -- node {$r = 0$} (sum);
    \draw [->] (sum) -- node {$e$} (relay);
    \draw [->] (plant) -- node [name=y] {$y$}(output);
    \draw [-] (y) |- (measurements);
    \draw [->] (measurements) -| node[pos=0.99] {$-$} 
        node [near end] {} (sum);
\end{tikzpicture}
}
\end{center}
	\captionof{figure}{Relay feedback}
	\label{relay_feedback}
\end{minipage}
\end{figure}
\begin{figure}[h!]
\includegraphics[width = 0.8\textwidth]{simple_relay_feedback.jpg}
\caption{Oscillations in a relay feedback system. The relay switches when the plant reaches the hysteresis limits $\pm \epsilon$, causing the plant to oscillate between those limits.}
\label{relay_feedback_oscillations}
\end{figure}
\color{black}


Figure \ref{relay_feedback} reveals how a typical relay feedback system is connected. The output of a plant ($y$), is connected to the relay ($e = -y$), and the output of the relay is input to the plant. Relay feedback systems tend to cause oscillations as the plant is subjected to maximal input (high or low) in the opposite direction when the plant exceeds a threshold ($\epsilon$ or $-\epsilon$), as shown in  Figure \ref{relay_feedback_oscillations}.

Relay feedback systems combine analogue and digital signals, which is reminiscent of switching behaviour in biological oscillations.

\subsection{Symmetric oscillations}
Consider the linear time invariant system:
\begin{eqnarray}
\begin{array}{l}
\displaystyle \dot{x} = Ax + Bu \\
\displaystyle y = Cx \\
\end{array}
\label{LTIsystem}
\end{eqnarray}

When this system is connected to the relay (1), with $e = -y$, the system can have a symmetric limit cycle of period $T=2h$ if the following condition is met:
\begin{equation} \label{eq:2_3}
C(I+e^{Ah})^{-1}\int_0^he^{As}B\text{d}s = \tfrac{\epsilon}{d}
\end{equation}

This theorem is able to deal with high dimensional systems, giving a general approach to analysing nonlinear models of oscillations. 

\subsection{Asymmetric oscillations}\label{sec:asymm_oscillations}

When the relay is characterized by:

\begin{equation}
	u(t)=\begin{cases}
	               d_1 \text{ if } e > \epsilon \text{ or } (e >-\epsilon \text{ and } u(t-) = d_1)\\
	                -d_2 \text{ if } e < -\epsilon \text{ or } (e < \epsilon \text{ and } u(t-) = -d_2)\\
	              
	            \end{cases}
                \label{asymmetric_relay_equation}
\end{equation}

The LTI system given by (\ref{LTIsystem}) can have asymmetric oscillations when $e=-y$ and the following conditions for a limit cycle with period $T$ are met:
\begin{equation}
\begin{cases}
C(I-\Phi)^{-1}(\Phi_2\Gamma_1d_1-\Gamma_2d_2) = -\epsilon \\
C(I-\Phi)^{-1}(-\Phi_1\Gamma_2d_2+\Gamma_1d_1) = \epsilon \\
\end{cases}
 \label{eqtn5_2}
\end{equation}
where
\begin{equation}
\begin{array}{l}
\displaystyle \Phi = e^{AT}  \text{  ,  }\Phi_1 = e^{A\tau} \text{  ,  }  \Phi_2 = e^{A(T-\tau)} \\
\displaystyle \Phi_1 = \int_0^\tau e^{As}\text{d}sB \text{  ,  } \Gamma_2 = \int_0^{T-\tau}e^{As}\text{d}sB
\end{array}
\end{equation}
The asymmetric oscillation is split into two parts, a period when the relay output is low, $\tau$ and the period when the relay output is high, $T-\tau$, as shown in Figure \ref{fig:asym_relay_oscillations}.

\begin{figure}[h!]
\includegraphics[width = 0.8\textwidth]{asym_relay_feedback}
\caption{Asymmetric oscillations with relay feedback.}
\label{fig:asym_relay_oscillations}
\end{figure}

In this project, once a model was approximated using relay feedback, the tools stated above were used to predict the existence of limit cycles and their time periods. Parameters of a model could be varied and their effect understood by the above equations. \cite{astrom1995} also derived initial conditions for these oscillations and how to check the local stability of the oscillations, which again were used to analyse each model.

\FloatBarrier
\section{Relay feedback models of fundamental biological limit cycles}\label{Sec:continous oscillations}
Two fundamental models of continuous oscillations in biology will be modelled as simple relay feedback systems in this section. This proof of concept step reveals the use of relay feedback in order to predict time periods of oscillations and understanding how different parameters affect oscillations. 

\subsection{Goodwin oscillator model}
The Goodwin oscillator is a biochemical oscillator model based on negative feedback alone. This genetic oscillator describes the conceptual mechanism of how mRNA, protein and end product interact. Written in their non-dimensional form \cite{fall}, the Goodwin oscillator's kinetic equations are:
\begin{align}
\frac{dx_1}{dt'} &= \frac{1}{1 + x_3^p} - b_1x_1 \\
\frac{dx_2}{dt'} &= b_2(x_1 - x_2) \\
\frac{dx_3}{dt'} &= b_3(x_2 - x_3)
\end{align}
where $x_1,x_2.x_3$ are non-dimensionalised concentrations of mRNA, protein and end product, respectively. 
\noindent The only nonlinearity, $(\frac{1}{1 + x_3^p})$, becomes a relay with no hysteresis as $p \rightarrow \infty$ (see Figure \ref{goodwin_nonlinearity}).

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth]{goodwin_nonlinearity.jpg}
\caption{Nonlinearity becomes a relay with no hysteresis, as $p \rightarrow \infty$.}
\label{goodwin_nonlinearity}
\end{figure}
\begin{figure}[h!]
\centering
%\resizebox{6cm}{!}{%
\begin{tikzpicture}[auto, node distance=2cm,>=latex]
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]   % We start by placing the blocks

\def\relay{
\tikz[remember picture,overlay]{
\draw[->] (-.8,-.3) -- (.8,-0.3);
\draw[->] (-.3,-0.45)--(-.30,0.45);
\draw[blue] (0.7,-0.28)--(0.,-0.28)--(0,0.2)--(-.7,.2);
%\draw[blue] (-.2,.2)--(-.2,-.2)--(.2,-.2);
}}

    \node [block] (inverse) {};
    \node[] at (inverse) {\relay};
    \node [output, right of = inverse] (output) {};
    \node [input, left of = inverse](input){};
    \node [block, below of = inverse](linear_tf){\large $\frac{-1}{s^3 + 3s^2 + 3s + 1}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [-] (inverse) -- (output);
    \draw [->] (output) |- node[near start] {$u$}(linear_tf);
    \draw [-] (linear_tf) -| node[near end] {$y$} (input);
    \draw [->] (input) -- (inverse);

\end{tikzpicture}
%}
\caption{Relay feedback system model of Goodwin oscillator ($b_1=b_2=b_3=1$). }
\label{goodwin_transfer}
\end{figure}

Setting $b_1 = b_2 = b_3 = 1$ (for simplicity) and rewriting the equations such that the linear equations form the plant and the nonlinearity is a relay, results in the system shown in Figure \ref{goodwin_transfer} with state space realisation: 
\begin{align}\label{eq:goodwin_relay_state_space}
\dot{x} &= \begin{bmatrix}
-1 & 0 & 0 \\  1  & -1 & 0 \\ 0 & 1 & -1
\end{bmatrix}x + \begin{bmatrix}1 \\0 \\0 \end{bmatrix}u \\
y &= \begin{bmatrix} 0 & 0 & 1 \end{bmatrix} u\\
u &=\begin{cases} 	               0 \text{ if } e \geq 1)\\
	                1 \text{ if } e < 1)\\\end{cases}
\end{align}

Using the theory for asymmetric oscillations, initial conditions were derived numerically. The limit cycle with the appropriate time period was shown to be locally stable and the simulations of the Goodwin model (with a large $p$) and the relay feedback model were very similar (see Figure \ref{goodwin_matching}). This (novel) use of relay feedback systems to model biological oscillations is a link between classical control theory and biological models. The relay feedback model of gene dynamics explicitly models the logic of a gene turning off/on, and gives new insight into understanding these oscillations. This framework  gives us a methodology to approach high-dimensional models of circadian rhythms, such as the 10 dimensional model for circadian  oscillations in \textit{Drosophila} \cite{leloup}. 

\begin{figure}[h!]
\includegraphics[width = .8\textwidth]{goodwin_mathcing}
\caption{Relay system models Goodwin oscillator well as $p\rightarrow\infty$.}
\label{goodwin_matching}
\end{figure}

\FloatBarrier
\subsection{FitzHugh-Nagumo model}
In this section, the use of relay feedback systems is extended to model a system where the relay is not as `obvious', as was in the previous section.
\subsubsection{Introduction}
The Hodgkin-Huxley model\cite{huxley} was the first quantitative model of the propagation of an electrical signal along a squid giant axon \cite{keener}. It is considered as one of the most important mathematical models in all of the physiological literature \cite{keener}, and led to the study of excitable systems.  The FitzHugh-Nagumo model simplifies the Hodgkin-Huxley model (of four variables) in terms of two variables, one fast and one slow. The FitzHugh-Nagumo model exhibits as clearly as possible the basic dynamic interrelationships between the variables of state which are responsible for the properties of threshold, refractoriness, and finite and infinite trains of impulses\cite{fitzhugh}.  With the fast variable, $v$, representing the voltage and the slow variable, $w$, representing the current, the FitzHugh-Nagumo model is:
\begin{align}
\epsilon\dot{v} &= f(v) - w + I_\text{app}\\
\dot{w} &= v - \gamma w
\end{align}
where: 
\begin{equation*}
\epsilon \ll 1 \text{  and  } f(v) = v(1-v)(v-\alpha) \text{ , } 0 <\alpha<1 .
\end{equation*} 
$I_\text{app}$ is the externally applied current (representing the stimulus). The nullclines\footnote{The nullcline is the line along which a variable's time derivative is zero} of the fast and slow variables have a cubic shape and a linear shape respectively.   The input current, $I_\text{app}$, shifts the cubic nullcline, affecting where the nullclines intersect, i.e the equilibrium points. For certain input currents, the nullclines intersect at only one (unstable) point and cause continous oscillations. With $\alpha =0.1, \gamma = 0.5, \epsilon = 0.01$ and $I_{\text{app}}=0.5$, the uniqure rest point is unstable. Since $\epsilon \ll 1 $, the fast variable tries to follow the stable branches of the cubic nullcline where possible and then quickly jumps to the other stable branch. That is the voltage stays at a high value for some time and then quickly jumps to a low value and then jumps up to a high value (see Figure \ref{fig:FN_intro}).  Meanwhile, the current slowly adapts to the high/low value of the voltage, pushing the system to leave the stable branches eventually. The behaviour of the system in the phase plane follows from singular perturbation theory\cite{keener}. 

\begin{figure}
\centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{fitz_nagumo_hysteresis.jpg}
        \caption{Phase portrait. The cubic nullcline is shown as the dashed line.}
        \label{fig:FN_intro_hysteresis}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{fitz_nagumo_voltage_time.png}
        \caption{Voltage oscillations.}
        \label{fig:FN_intro_voltage}
    \end{subfigure}
    \caption{Continous oscillations in the FitzHugh-Nagumo model.}
    \label{fig:FN_intro}
\end{figure}

\begin{figure}
\centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{fitz_nagumo_speed}
        \caption{Phase portrait. Hysteresis becomes more linear and `relay'.}
        \label{fig:FN_eps_hysteresis}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{fitz_nagumo_speed_voltage_time.png}
        \caption{Voltage oscillations become more `discrete', similar to a relay ouput.}
        \label{fig:FN_eps_voltage}
    \end{subfigure}
    \caption{In the limit $\epsilon\rightarrow0$, the voltage ouput looks like the output of a relay. The hysteresis looks like a skewed relay. }
    \label{fig:FN_eps_zero}
\end{figure}

\subsubsection{Converting to relay feedback model}\label{sec:FN_to_relay}

As $\epsilon\rightarrow 0$, the phase portrait of the voltage and current becomes more and more linear and closely resembles a rotated relay with hysteresis (Figure \ref{fig:FN_eps_zero}). This can be understood as  high gain inversion \cite{goodwin}, and the voltage behaves like the ouput of a skewed relay. So, when the system is continuously oscillating, it allows us to replace the cubic nullcline with a skewed relay (see Figure \ref{original_nonlinearity1}). 

\begin{figure}[h!]
\begin{subfigure}[t]{.4\textwidth}

\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
\resizebox{5cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=0.75]
      % We start by placing the blocks
      \node at (0,3) (I_app) {$I_{app}$};
      %\node[input, name = I_app]{text};
      \node[sum, right of = I_app](sum_outer){};
      \node [sum, right of = sum_outer] (sum_inner) {};
      \node [block, right of = sum_outer, node distance=3cm] (high_gain) {\large{$\frac{1}{\epsilon s}$}};
      % We draw an edge between the controller and system block to 
      % calculate the coordinate u. We need it to place the measurement block. 
      \node [output, right of = high_gain] (output) {};
      \node [block, below of = high_gain] (cubic_nullcline) {$f(\cdot)$};
      \node [block, below of = cubic_nullcline](linear_tf){\large $\frac{1}{s+\gamma}$};

      % Once the nodes are placed, connecting them is easy. 

      % inner loop
      \draw [draw,->] (sum_outer) -- node {$+$} (sum_inner);
      \draw [->] (sum_inner) -- node {$\dot{v}$} (high_gain);
      \draw [->] (high_gain) -- node [name=v] {$v$}(output);
      \draw [->] (v) |- (cubic_nullcline);
      \draw [->] (cubic_nullcline) -| node[pos=.85] {$+$} 
          node [near end] {} (sum_inner);

      % outer loop
      \draw [->](v) |- (linear_tf);
      \draw [->](linear_tf) -| node[anchor=south,pos=0.2] {$w$} 
          node[pos=0.93]{-}(sum_outer);
      \draw [->](I_app)-- node[near end]{$+$} (sum_outer);
  \end{tikzpicture}}
	\caption{Block diagram}%
	\label{fitz_nagumo_block_diagram1}%
\end{subfigure}
\hspace{0.5cm}%
\begin{subfigure}[t]{.45\textwidth}
\centering
\begin{tikzpicture}[scale = 0.65]
  \begin{axis}[
    xmin=-.4,xmax=1.52,
    ymin=0.4,ymax=.72,
    axis lines=center,
    axis line style=->,
    xlabel={$v$},
    ylabel={$w$}
    ]
      \addplot[-] [color=red, style = thick] expression[domain=-0.45:1.2,samples=100]{-x^(3)+(1+0.1)*x^(2) - 0.1*x + 0.5}; 
      \addplot[-] [color=blue, style = thick] coordinates{(-.2693,0.6262) (.6883,.6262)};
            \addplot[<-] [color=blue, style = thick] coordinates{(.2693,0.6262) (.6883,.6262)};
            \addplot[<-] [color=blue, style = thick] coordinates{(.1993,0.6262) (.6883,.6262)};
      \addplot [color=blue, style = thick] coordinates{(.6883,0.6262) (1.003,.4976)};
      \addplot [color=blue, style = thick] coordinates{(-.2693,0.6262) (-.0061,.4976)};
      \addplot [-][color=blue, style = thick] coordinates{(-.0061,.4976) (1.003,.4976)};
      		\addplot [->][color=blue, style = thick] coordinates{(-.0061,.4976) (.6,.4976)};
            \addplot [->][color=blue, style = thick] coordinates{(-.0061,.4976) (.53,.4976)};
     % \addplot[-] [color=green, style = thick] expression[domain=-0.45:1.2,samples=100]{-y^(3)+(1+0.1)*y^(2) - 0.1*y + 0.5}; 
     \addlegendentry{$f(\cdot)$}
	 \addlegendentry{Relay approximation}
	\end{axis}
\end{tikzpicture}
	\caption{Nonlinearity and the ``relay" approximation}%
	\label{original_nonlinearity1}%
\end{subfigure}
\caption{FitzHugh-Nagumo model.}
\label{fn}
\end{figure}


\underline{High gain inversion}
\begin{align}
0 &= f(v) -w + I_{\text{app}}\\
v &= f^{-1}\left(w - I_{\text{app}}\right)\\
v&\approx \text{Relay}(w) 
\end{align}

This allows us to replace the inner loop in \ref{fitz_nagumo_block_diagram1}. With a shift in co-ordinates to make the `relay' symmetric about the orgin, and a change of basis so that an unskewed relay can be used, results in the relay feedback system in Figure \ref{fig:fitz_nagumo_relay_block_diagram}. Details of this transformation are illustrated in the Appendix. Now, using equation (3), we can derive the time period of the oscillation and its local stability. The results are shown in Figure \ref{fig:matching_fitz_relay}. The relay feedback model matches the oscillations very closely. 

This model reveals how the oscillations can be understood as adaptation around a hysteresis. The current slowly adapts to each change in voltage, around the relay hysteresis, causes the voltage to oscillate. 

\begin{figure}[h!]

\begin{tikzpicture}[auto, node distance=2cm,>=latex, scale = 0.25]
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]   % We start by placing the blocks

\def\relay{
\tikz[remember picture,overlay]{
\draw[->] (-.8,0) -- (.8,0);
\draw[->] (0,-0.45)--(0,0.45);
\draw[blue] (0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(-.7,.2);
\draw[blue] (-.2,.2)--(-.2,-.2)--(.2,-.2);
}}

    \node [block] (inverse) {};
    \node[] at (inverse) {\relay};
    \node [output, right of = inverse] (output) {};
    \node [input, left of = inverse](input){};
    \node [block, below of = inverse](linear_tf){\large $\frac{1}{s+\gamma-\xi}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [-] (inverse) -- (output);
    \draw [->] (output) |- node[near start] {$u$}(linear_tf);
    \draw [-] (linear_tf) -| node[near end] {$y$} (input);
    \draw [->] (input) -- (inverse);

\end{tikzpicture}
\caption{Relay feedback model of FitzHugh-Nagumo.}
\label{fig:fitz_nagumo_relay_block_diagram}
\end{figure}

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \includegraphics[width=\textwidth]{tmr_fn_relay_limit_cycle}
        \caption{Phase Portrait. Voltage is like the output of a skewed relay.}
        \label{fig:f_n_relay_limit_cycle}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
    %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[t]{0.45\textwidth}
        \includegraphics[width=\textwidth]{tmr_fn_relay_voltage}
        \caption{Voltage oscillations against time. Voltage alternates between a high state and a low state.}
        \label{fig:f_n_relay_voltage}
    \end{subfigure}
\caption{FitzHugh-Nagumo model and Relay feedback model match in $\lim\limits_{\epsilon\to 0}$}
\label{fig:matching_fitz_relay}
\end{figure}

\FloatBarrier


\section{Relay feedback model of nested oscillations}\label{Sec:nested oscillations}
In the previous section, the use of the relay feedback framework for analysing simple oscillations was found to be very useful. Now the question arises as to whether this framework is capable of tackling complex oscillations. Bursting, a complex oscillation, can be understood as the interaction between two excitable systems with different time scales\cite{drion}. In other words, it can be understood as two coupled FitzHugh-Nagumo models. 

In this section, the use of relay feedback analysis is extended to bursting. Following how \cite{rinzel} split bursting into two subsystems, we dissect a bursting normal form into two coupled relay feedback systems. 

\subsection{Bursting}
Bursting is an important signaling component of neurons, characterized by a periodic alternation of bursts (periods of rapid oscillatory activity) and quiescent (membrane potential changes slowly) periods \cite{franci2}. Bursting observed in cells can have a wide variety of periods, ranging from a few seconds to a few minutes \cite{keener}. This general phenomenon is believed to play an important role in several signalling mechanisms. Bursting can also be viewed as a two state automaton in frequency \cite{drion}; encoding memory into four states-- resting, fast oscillations, slow oscillations and bursting. 

All neuronal bursters have three distinct time scales: a fast time-scale for spike generation, a slow time-scale for the intraburst spike frequency, and an ultra slow time-scale for the inter burst frequency\cite{franci2}. The bursting property can be understood in terms of a few canonical positive and negative feedback motifs localized in distinct time scales \cite{drion}, as shown in Figure \ref{fig:p_n_feedbacks}.

\begin{figure}[h!]
\includegraphics[width = 0.5\textwidth]{feedback_interactions}
\caption{Scheme of the four-state automaton showing the different feedbacks and their localization in frequency (from top to bottom) and in range (from left to right). Green arrows represent positive feedbacks and red arrows represent negative feedbacks. Ionic currents repsonsible for the described feedbacks are noted inside the respective arrows.Source \cite{drion}.}
\label{fig:p_n_feedbacks}
\end{figure}

This separation of timescales is used to decompose bursting into two coupled relay feedback systems. As a first step, a bursting model normal form from \cite{franci} is introduced. Then we will step through each of the positive and negative feedbacks, starting at shortest timescale, and examine how to tranform this into relay feedback. Then, the nonlinearites will be simplified to reduce the model into relay feedback systems. 

\subsection{A three-time scale bursting normal form}
The three-time scale bursting normal form organized by the winged cusp singularity is presented in \cite{franci}. It is based on unfolding of the organizing center called the winged cusp to obtain a finite family distinct,robust static behaviours \cite{franci}. The model is based on Singularity theory and the interested reader is referred to \cite{franci} for a comprehensive exposition of how this model realises a variety of nonlinear behaviours. 

A key point of this model is the robust co-existence of a stable fixed point and a stable relaxation limit cycle as shown in Figure \ref{fig:bursting_fundamental_phase_portait}. That is the model is rest-spike bistable. When spiking, the stable limit cycle is similar to the FitzHugh-Nagumo model's phase portrait. This model generalizes FitzHugh-Nagumo by adding a third variable (ultra-slow) in negative feedback, which adapts in the dimension normal to the phase portrait (see Figure \ref{fig:3d_bursting}). The basic idea is that there are slow processes which modulate the faster spike generating dynamics \cite{rinzel}. The ultra-slow adaptation switches the behaviour between spiking and resting. The state-space equations for this model are:
\begin{equation}
\begin{array}{l}
\displaystyle \epsilon_f\dot{x}_{f} = -x_f + S\left(x_f + B_\delta\left(u + x_s + \tfrac{\gamma}{2}x_f\right) + \beta x_f + \alpha  - x_{us}  \right)\\
\displaystyle \dot{x}_{s} = x_f - x_s \\
\displaystyle \dot{x}_{us} = \epsilon_u\left(-x_{us} + k_u(x_f+\bar{x}_u) \right)\\
\end{array}
\label{eq:restSpikeBistability}
\end{equation}
where:
\begin{equation}
\begin{array}{l}
\displaystyle \text{Sigmoid nonlinearity: }S(u) = \text{tanh}(u) \\
\displaystyle \text{Bump nonlinearity: }B_\delta(u) := S(u+\delta) - S(u-\delta) -2S(\delta),\hspace{0.4cm} \delta\neq0
\end{array}
\end{equation}


\begin{figure}[h!]
\includegraphics[width = 0.5\textwidth]{winged_cusp_phase_portrait}
\caption{Phase portrait (qualitative) of the three-time scale bursting normal form. $N_s$ is the stable equilibrium, $N_u$ is the unstable equilibrium, $S$ is the saddle point, $W_s^\epsilon$ is the stable manifold of $S$ and $l^\epsilon$ is a stable limit cycle. The thick black line is the fast variable's nullcline, known as the mirrored hysteresis (winged cusp singularity) and the slow variable's nullcline is the thin straight line. Source \cite{franci2}.}
\label{fig:bursting_fundamental_phase_portait}
\end{figure}

\begin{figure}[h!]
\includegraphics[width = 0.7\textwidth]{franci_3d_bursting}
\caption{Three-dimensional singular invariant set $\mathcal{M}^0$ (left), which provides a skeleton for a three-time scale bursting attractor (right). The ultra-slow parameter adapts to switch the system from spiking to resting and vice versa. See \cite{franci2} Figure 4 for details. Source \cite{franci2}.}
\label{fig:3d_bursting}
\end{figure}

The block diagram for this circuit is shown in Figure \ref{fig:ttsbursting_circuit}. Typical bursting is shown in Figure \ref{fig:bursting_typical_oscillations}. 

\begin{figure}[h!]
\includegraphics[width = 0.7\textwidth]{tts_circuit}
\caption{Three-time scale bursting normal form block diagram. Source \cite{franci}.}
\label{fig:ttsbursting_circuit}
\end{figure}

 \begin{figure}[h!]
\includegraphics[width = 0.5\textwidth]{original_bursting.jpg}
\caption{Bursting. The ultra-slow oscillations of the $x_{us}$ switches the output $x_f$ between spiking and resting.}
\label{fig:bursting_typical_oscillations}
\end{figure}

\subsubsection{The fast positive feedback}
\begin{figure}[h!]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{block2} = [draw,  rectangle,  minimum height=4em, minimum width=7em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{gain2} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 30, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
%\tikzstyle{input} = [coordinate]
%\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

\def\saturationA
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.5,0) -- (.5,0);
		\draw[->] (0,-.5)--(0,.5);
		\draw[blue] (-.5,-.3)--(-.1,-.3)--(.1,.3)--(.5,.3);
		\node at (-.2,0.1) {\tiny$-1$};
		\node at (.1,-0.1) {\tiny$1$};
	}
}

\def\saturationB
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-1,0) -- (1,0);
		\draw[->] (0,-.75)--(0,.75);
		\draw[blue] (-1,-.5)--(.3,-.5)--(-.3,.5)--(1,.5);
		\node at (-.45,0.1) {\tiny$1-\beta$};
		\node at (.45,-0.15) {\tiny$\beta-1$};
	}
}

\resizebox{13cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=.25]
      % We start by placing the blocks
      
      % Orignal loop
      \node [block]at (0,-3) (satA){};
      \node [] at (satA) {\saturationA};
      \node [coordinate, right of = satA](endB){};
      \node [gain, above of = satA](beta){ $\beta$};
      \node [left of = beta](inB){};
      

      % Once the nodes are placed, connecting them is easy. %

	% ultra-slow loop
	\draw[-](satA)--(endB);
	\draw[->](endB)|- node[name = middlepoint, near start]{} (beta); 
	\draw[-](beta)--(inB);
	\draw[->](inB)|-node[pos=.5, name = edgejoint]{} (satA);
	\draw[-](beta)-|(edgejoint);
     
     % Equal to sign
     \node[right of = middlepoint, node distance = .7cm](equalToSign){\large $=$};
     \node [block2, right of = equalToSign, node distance = 2cm](saturationB){};
     \node [] at (saturationB) {\saturationB};
     \node [right of = saturationB, node distance = 4cm]{$y= \begin{cases}1 \text{ if } x \geq 1-\beta\\-1 \text{ if } x\leq \beta -1\end{cases} $};
     

  \end{tikzpicture}
}
\caption{For the saturation function, for $\beta > 1$, the nonlinearity gains a hysteresis of width $2\beta$. }
\label{fig:positive_feedback_hysteresis}
\end{figure}

The fast positive feedback in Figure \ref{fig:ttsbursting_circuit} is the feedback of $H_f(s)$ through the gain $\tilde{\beta}$ and the sigmoid nonlinearity. The fast positive feedback creates a nonlinearity with hysteresis. This can be understood by considering positive feedback for a saturation function, shown in Figure \ref{fig:positive_feedback_hysteresis}. By assuming that $x_f$ is much faster than the other variables, we can replace the positve feedback loop as a relay. This is equivalent to $\epsilon_f\rightarrow 0$, which was done earlier for the FitzHugh-Nagumo model. 

\subsubsection{The slow negative and slow positive feedback}
\begin{figure}[h!]
\includegraphics[width=0.6\textwidth]{bump}
\caption{Bump nonlinearity}
\label{fig:bump_nonlinearity}
\end{figure}
In the slow timescale, there is a mixture of positive and negative feedbacks. This balance of feedback provides a closed-loop behaviour that is either a regulator or a switch \cite{drion}. In the normal form, it is the bump nonlinearity (Figure \ref{fig:bump_nonlinearity}) that plays this role and affects what kind of feedback the slow plant provides. ``Rest-spike bistability requires that the stable equilibrium be in the regenerative region, that is the region where the slow feedback is positive."\footnote{Prof.Sepulchre, 2016}. This is achieved in the model by having the stable equilibrium in the region where $x_s$ is negative, and the system operates in the region where the bump has a positive gradient. When the system is spiking, the input to the bump is always greater than zero. The bump provides negative feedback in this region, causing the slow plant to adapt around the hysteresis of the sigmoid nonlinearity. That is, when spiking, the model essentially simplifies down to the FitzHugh-Nagumo model during continous oscillations. 


\subsubsection{The ultra-slow negative feedback}
\begin{figure}[h!]
\includegraphics[width = 0.9\textwidth]{restSpikeBistableAlpha}
\caption{Fast nullcline changing as $\alpha$ increases. Within a fixed range of $\alpha$, the system has both the resting and the spiking equilibrium. This is the bistable range.}
\label{fig:alphaParameter}
\end{figure}
In the ultra-slow time scale, the $H_{us}$ provides negative feedback. To understand how this affects the nullcline of the fast variable, the (unfolding) parameter $\alpha$ (see Figure \ref{fig:ttsbursting_circuit}) should be examined. The (unfolding) parameter $\alpha$ modulates monotonically the winged-cusp singularity\cite{franci}, as shown in Figure \ref{fig:alphaParameter}. Consequently, as $x_{us}$ reaches a particular value (its maximum value), the nullclines of the fast and slow variables will only intersect at the stable fixed point (low $x_f$). This drives the system to the quiescent period, while $x_{us}$ slowly recovers. When $x_{us}$ reaches its minimum value, the nullclines of the fast and slow variables will only intersect at a high $x_{s}$ which then becomes the unstable fixed point as $x_{us}$ recovers. This drives the system to the spiking period. The bursting model thus relies on continously adapting this parameter, using the ultra-slow variable, around the bistable range (minimum and maximum value of $x_{us}$). 
It is clear now that the ultra-slow parameter can be modelled as a relay feedback system, oscillating around the bistable range. 


\subsubsection{Using piece-wise linear non-linearities}
Using linear approximations of the non-linearieties allow us to simplify them to linear gains. As shown in Figure \ref{fig:sigmoid_linear}, the saturation function is a good approximation to the sigmoidal nonlinearity. Furthermore, since the positive feedback gain is $\tilde{\beta}:=1 + \beta$, this can be replaced by a positive feedback of just $\beta$ around a relay with no hysteresis (equivalent to the sign($\cdot$) function). This is then equivalent to a relay with hysteresis limits $\pm \beta$. 

The bump nonlinearity with $\delta$ set to 0.5, can be approximated by the piecewise linear function shown in Figure \ref{fig:bump_linear}. The piecewise linear function simplifies the model very nicely since the positive/negative feedback gain is constant. The piecewise linear function is:
\begin{equation}
B_p:= \begin{cases}
\frac{1}{2}x \text{ \hspace{3cm}  if } -2<x<0 \\
-\frac{1}{2}x \text{\hspace{3cm}if } 0<x<2 \\
-1 \text{ \hspace{3cm}  otherwise}
\end{cases}
\end{equation}

\begin{figure}[p]
\includegraphics[width = 0.5\textwidth]{tanh_and_saturation}
\caption{The $S(\cdot)$ and the saturation functions. The saturation function is a good approximation to the $S(\cdot)$. }
\label{fig:sigmoid_linear}
\end{figure}

\begin{figure}[p]
\includegraphics[width = 0.5\textwidth]{bump_piece_bump}
\caption{The $B_\delta(\cdot)$ with $\delta = 0.5$ and a piecewise linear approximation $B_p(\cdot)$.}
\label{fig:bump_linear}
\end{figure}
The system is now: 
\begin{equation}
\begin{array}{l}
\displaystyle \epsilon_f\dot{x}_{f} = -x_f + \text{sign}\left(B_p\left(u + x_s + \tfrac{\gamma}{2}x_f\right) + \beta x_f + \alpha  - x_{us}  \right)\\
\displaystyle \dot{x}_{s} = x_f - x_s \\
\displaystyle \dot{x}_{us} = \epsilon_u\left(-x_{us} + k_u(x_f+\bar{x}_u) \right)\\
\end{array}
\label{eq:restSpikeBistability}
\end{equation}

The system's phase portrait is shown in Figure \ref{fig:linearised_phase_portrait}. The new fast nullcline approximates the original nullcline well. 

\begin{figure}[p]
\includegraphics[width = 0.5\textwidth]{linearised_phase_portrait}
\caption{Phase portrait using piecewise-linear nonlinearities. The original fast nullcline is plotted in green for comparison. Note that the lines showing $\dot{x}_f=0$ where $-1<x_f<1$ does not exist algebraicly. Numerical computing leads to those lines.}
\label{fig:linearised_phase_portrait}
\end{figure}

\newpage
\subsubsection{Separation of time scales to separate into relay feedback systems}
By assuming that the fast variable changes instantaneously ($e_f\rightarrow0$), the innermost loop involving the fast plant $H_f$ can be replaced by a relay with hysteresis (Figure \ref{fig:bursting_step1}). 

While the system is spiking, the bump nonlinearity can be replaced by a constant gain providing negative feedback. Furthermore, Figure \ref{fig:bursting_step2.1} shows how the ultra slow variable can be viewed as nearly constant. This is equivalent to the relay feedback system with a slowly shifting hysteresis (Figure \ref{fig:bursting_step2}). 

Setting $\gamma = 0$ (without loss of generality), gives a hysteresis for the new system that is not skewed (transformation for skewed hysteresis was carried out in Section \ref{sec:FN_to_relay}). This is now a simple relay feedback system, modelling the spiking. Uing the analytical results from \cite{astrom1995} we can now predict the time periods of the fast oscillations. The shifting of the hysteresis limits, due to the ultra slow variable, simply change the time periods of the oscillations as shown in Figure\ref{fig:bursting_step2.1}.

The ultra-slow variable, due to its slow time constant, can be regarded as only responding to an ``averaged" $x_f$. Figures \ref{fig:bursting_step3.1} and \ref{fig:bursting_step3.2} reveal the response of $\alpha$ to a moving average $x_f$. The relay hysteresis limit is the bistable range of $\alpha$, while the maximum output of the relay is slowly changing as the ``averaged" $x_f$ varies as predicted from equation (5). This reveals how the bursting circuit has been simplified into two coupled oscillators. The fast-slow oscillator which reproduces the spiking and the averge-fast--ultra-slow oscillator which dictates when the model spikes and rests (see Figure \ref{fig:bursting_step4}). 

The transforming of the bursting model's normal form into relay feedback models enables us to analytically extract the time period of the ultra-slow oscillation and that of the fast oscillation. It also revealed how the two oscillators are linked and revealed how the duty cycle during spiking subtly changes due to the ultra-slow parameter. 

Furthermore, this is a step towards multirate feedback systems. \cite{kranc} developed a theory where an arbitrary multirate sampled system can be replaced by a system with a single-rate sampled system with advance and delay elements. This theory would be amenable to the study of multiple interconnected relay feedback systems, modelling complex biological oscillations. 


\begin{figure}[h!]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

\def\relay
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.45);
		\draw[blue] (-0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(.7,.2);
		\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
		\node at (-.4,0.1) {\tiny$\epsilon_2$};
		\node at (.4,-.1) {\tiny$\epsilon_1$};
	}
}

\def\piecebump
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.35);
		\draw[blue] (-0.7,-0.3)--(-0.2,-0.3)--(0,0)--(.2,-.3)--(.7,-.3);
			\draw[blue] (-0.7,-0.3)--(-0.2,-0.3)--(0,0)--(.2,-.3)--(.7,-.3);
		%\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
	}
}
\resizebox{12cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=1]
      % We start by placing the blocks
      \node at (0,3) (u) {$u$};
      %\node[input, name = I_app]{text};
      \node [sum, right of = u](sum_outer){};
      \node [block, right of = sum_outer] (bump){};
           \node [] at (bump) {\piecebump};
      \node [sum, right of = bump, node distance = 3cm] (sum_inner) {};
      \node [block, right of = sum_inner, node distance=3cm] (relay) {};
      \node [] at (relay) {\relay};
      % We draw an edge between the controller and system block to 
      % calculate the coordinate u. We need it to place the measurement block. 
      \node [output, right of = relay,node distance = 4cm] (output) {x};
      \node [above of =  output, node distance = +0.1cm]{$x_f$};
      \node [block, below of = relay] (Hus) {\large $H_{us}$};
      \node [sum, right of = Hus, node distance = 2cm](sum_ultra_slow){};
      \node [input, above of = sum_ultra_slow, node distance = 1cm](ultra_slow_const){$\bar{x}_{us}$};
      \node [block, below of = Hus](Hs){\large $H_s$};
      \node [gain, above of = sum_inner](gamma){\large $\frac{\gamma}{2}$};%


      % Once the nodes are placed, connecting them is easy. %

     % inner loop
     \draw [->] (sum_outer) -- node {} (bump);
     \draw [->] (bump) -- node {$+$} (sum_inner);
     \draw [->] (sum_inner) -- node {} (relay);
     \draw [->] (relay) -- node [name=xf, label={[label distance=-.0cm]0:}] {} (output);
     %\node [] at (xf){$\mid$};
%     \draw [->] (relay) --  edge node[name = xf, anchor=center, text width=3.5cm, auto, midway] {} (output);
     %      \node [name = xf2,above of = xf]{};
     \draw [->] (xf) |- (sum_ultra_slow);
     \draw [->] (sum_ultra_slow) -- (Hus);
     \draw [->] (Hus) -| node[pos=.85] {$-$} 
         node [near end] {} (sum_inner);
     \draw [->] (ultra_slow_const) -- node[above,pos = -.05] {$\bar{x}_{us}$}(sum_ultra_slow);

     % outer loop
     \draw [->] (xf) |- (Hs);
     \draw [->] (Hs) -| node[anchor=south,pos=0.2] {$x_s$} 
         node[pos=0.93]{+}(sum_outer);
     \draw [->] (u)-- node[near end]{$+$} (sum_outer);
     \draw [->] (11.629,3) |- (gamma);
     %\draw [->] (xf) -- (xf2);
     \draw [->] (gamma) -| (sum_outer);
     
     %\draw [->]-| node[near end]{$+$}(sum_outer);
  \end{tikzpicture}
}
\caption{Inner loop replaced by relay with hysteresis. The hysteresis limits are $\epsilon_1 = \beta$ and $\epsilon_2 = \beta$.}
\label{fig:bursting_step1}
\end{figure}



\begin{figure}[tbp]
\includegraphics[width = 0.5\textwidth]{slow_fast}
\caption{Variables changing during a very short period of spiking. The slow variable is adapting around the static hysteresis, like in the FitzHugh-Nagumo model. The ultra slow variable is changing very slowly.}
\label{fig:bursting_step2.1}
\end{figure}

\begin{figure}[tbp]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{gain2} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 30, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

\def\relay
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.45);
		\draw[blue] (-0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(.7,.2);
		\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
		\node at (-.4,0.1) {\tiny$\epsilon_2$};
		\node at (.4,-.1) {\tiny$\epsilon_1$};
	}
}

\def\piecebump
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.35);
		\draw[blue] (-0.7,-0.3)--(-0.2,-0.3)--(0,0)--(.2,-.3)--(.7,-.3);
			\draw[blue] (-0.7,-0.3)--(-0.2,-0.3)--(0,0)--(.2,-.3)--(.7,-.3);
		%\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
	}
}
\resizebox{10cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=1]
      % We start by placing the blocks
      %\node at (0,3) (u) {$u$};
      %\node[input, name = I_app]{text};
      \node [sum] at (0,3) (sum_outer){};
      \node [gain2, right of = sum_outer] (bump){$k_b$};
      %\node [sum, right of = bump, node distance = 3cm] (sum_inner) {};
      \node [block, right of = bump, node distance=3cm] (relay) {};
      \node [] at (relay) {\relay};
      % We draw an edge between the controller and system block to 
      % calculate the coordinate u. We need it to place the measurement block. 
      \node [output, right of = relay, node distance = 3cm] (output) {x};
      \node [above of =  output, node distance = +0.1cm]{$x_f$};
      %\node [block, below of = relay] (Hus) {\large $H_{us}$};
      %\node [sum, right of = Hus, node distance = 2cm](sum_ultra_slow){};
      %\node [input, above of = sum_ultra_slow, node distance = 1cm](ultra_slow_const){$\bar{x}_{us}$};
      \node [block, below of = relay](Hs){\large $H_s$};
      \node [gain, above of = relay](gamma){\small $\tfrac{\gamma}{2}$ };


      % Once the nodes are placed, connecting them is easy. %

     % inner loop
     \draw [->] (sum_outer) -- node {} (bump);
     \draw [->] (bump) -- (relay);
    % \draw [->] (sum_inner) -- node {} (relay);
     \draw [->] (relay) -- node [name=xf, label={[label distance=-.0cm]0:}] {} (output);
     %\node [] at (xf){$\mid$};
%     \draw [->] (relay) --  edge node[name = xf, anchor=center, text width=3.5cm, auto, midway] {} (output);
     %      \node [name = xf2,above of = xf]{};
     %\draw [->] (xf) |- (sum_ultra_slow);
     %\draw [->] (sum_ultra_slow) -- (Hus);
     %\draw [->] (Hus) -| node[pos=.85] {$-$} 
         %\node [near end] {} (sum_inner);
     %\draw [->] (ultra_slow_const) -- node {$\bar{x}_{us}$}(sum_ultra_slow);

     % outer loop
     \draw [->] (xf) |- (Hs);
     \draw [->] (Hs) -| node[anchor=south,pos=0.2] {$x_s$} 
         node[pos=0.93]{+}(sum_outer);
     %\draw [->] (u)-- node[near end]{$+$} (sum_outer);
     \draw [->] (7.135,3) |- (gamma);
     %\draw [->] (xf) -- (xf2);
     \draw [->] (gamma) -|node[pos=0.93]{+} (sum_outer);
     
     %\draw [->]-| node[near end]{$+$}(sum_outer);
  \end{tikzpicture}
}
\caption{Relay feedback system with slowly shifting hysteresis.$\epsilon_1 = \beta - \alpha - k_bu$ and $\epsilon_2 = -\beta - \alpha - k_bu$}
\label{fig:bursting_step2}
\end{figure}



\begin{figure}[tbp]
\includegraphics[width = 0.6\textwidth]{averagedRelay3}
\caption{Prediction of the duty cycle of the spiking oscillations changing with the ultra slow variable using the theory of asymmetric oscillations in relay feedback systems.}
\label{fig:bursting_step2.1}
\end{figure}


\begin{figure}
\includegraphics[width = 0.6\textwidth]{fastSlowaverg}
\caption{Moving average of $x_f$ changes during spiking as $\alpha$ changes the hysteresis limits.}
\label{fig:bursting_step3.1}
\end{figure}

\begin{figure}
\includegraphics[width = 0.6\textwidth]{shiftinghysteresis}
\caption{Trajectories on the phase plane reveal shifting hysteresis for $x_f$ and an approximate relay hysteresis for $\alpha$}.
\label{fig:bursting_step3.2}
\end{figure}

\begin{figure}
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{gain2} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 30, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
%\tikzstyle{input} = [coordinate]
%\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

\def\relayA
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.45);
		\draw[blue] (-0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(.7,.2);
		\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
		\node at (-.35,0.1) {\tiny$\epsilon_2$};
		\node at (.35,-.1) {\tiny$\epsilon_1$};
				\node at (0.6, 0.3) {\tiny$1$};
		\node at (-0.6,-0.3){\tiny$-1$};
	}
}

\def\relayB
{
	\tikz[remember picture,overlay]
	{
		\draw[->] (-.8,0) -- (.8,0);
		\draw[->] (0,-0.45)--(0,0.45);
		\draw[blue] (-0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(.7,.2);
		\draw[blue] (.2,.2)--(-.2,.2)--(-.2,-.2);
		\node at (-.45,0.1) {\tiny$\alpha_{min}$};
		\node at (.45,-.15) {\tiny$\alpha_{max}$};
		\node at (0.6, 0.3) {\tiny$\langle x_f \rangle$};
		\node at (-0.6,-0.3){\tiny$-1$};
	}
}

\resizebox{15cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=1]
      % We start by placing the blocks
      % Fast slow system
      \node at (-3,-1) (input1){};
      \node [block, right of = input1](relay1){};
      \node [] at (relay1) {\relayA};
      \node [coordinate, above of = relay1, node distance = 0.6cm](relay1_top){};
      \node [coordinate, right of = relay1] (endA) {};
      \node [block, below of = relay1] (Hs) {\large $H_s$};
      
      % Ultra slow system
      \node [block, right of = endA, node distance = 3cm](relay2){};
      \node [] at (relay2) {\relayB};
      \node [coordinate, below of = relay2, node distance = 0.6cm](relay2_top){};
      \node [coordinate, right of = relay2](endB){};
      \node [block, above of = relay2](Hus){\large $H_{us}$};
      \node [left of = Hus](inB){};

      % Once the nodes are placed, connecting them is easy. %

     % fast-slow loop
     \draw[->](-3,-1)--(relay1);
     \draw[-](relay1)--(endA);
     \draw[->](endA)|- node[name = xf,near start,left]{$x_f$} (Hs);
     \draw[-](Hs)-| node[name = xs,near end]{$x_s$}(-3,-1);

	% ultra-slow loop
	\draw[-](relay2)--(endB);
	\draw[->](endB)|-(Hus); 
	\draw[-](Hus)--(inB);
	\draw[->](inB)|- node[name = alpha, near start]{$x_{us}$}(relay2);
	\draw[-](Hus)-|(2,0);
     
     % coupling
     \draw[->,red](xf)-|node[below]{\tiny{Changing relay ouput by average of $x_f$}}(relay2_top);
     \draw[->,red](alpha)-|node[above]{\tiny{Shifting relay hysteresis by $x_{us}$}}(relay1_top);

  \end{tikzpicture}
}
\caption{Coupled relay feedback system. The $\langle x_f \rangle$-$x_{us}$ system affects the $x_f-x_s$ system by slowly shifting the hysteresis limits of the relay. The $x_f-x_s$ system affects the $\langle x_f \rangle$-$x_{us}$ system by changing the magnitude of the relay ouput.}
\label{fig:bursting_step4}
\end{figure}


\FloatBarrier
\subsection{Hindmarsh-Rose model}
The method of breaking down bursting into two coupled relay feedback systems is a general approach. This section proves this by examining how, the Hindmarsh-Rose neuronal bursting model, can be understood as the bursting normal form model and consequently two relay feedback systems. 
\subsubsection{Introduction}
The Hindmarsh-Rose model provides one of the simplest models of the more general phenomenon of oscillatory burst discharge \cite{hindmarsh}. It is a slight modification of the FitzHugh-Nagumo model for action potentials, with an extra ultra-slow variable. It uses a parabolic nullcline for the slow variable instead of the a straight line and the equations are:
\begin{align}
\epsilon_f\dot{x}_f &= x_s -x_{us} + f(x_f) + I \\
\dot{x}_s &= g(x_f) - x_s\\
\dot{x}_{us} &= \tau_{us}\left(k(x_f-\bar{x}_{us}) - x_{us}\right)
\end{align}
\begin{center}where  $f(x) = 3x^2 - x^3$ and $g(x) = 1 - 5x^2$. \end{center}

The fast variable, $x_f$, represents the membrane potential, the slow variable, $x_s$, is the current and $x_{us}$ is the (ultra-slow) adaptation current. For bursting, the parameters used are $\tau_{us} = 0.001, k = 4, \bar{x}_{us} = 1.6, I = 2$. The behaviour of the model can be seen in Figure \ref{fig:hRose_bursting}. The $\epsilon_f$ variable has been added to control the speed at which $x_f$ adapts. 

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \includegraphics[width=\textwidth]{hRose_phase_portrait}
        \caption{Phase Portrait. Voltage is like the output of a skewed relay as $\epsilon_f\rightarrow0$, just like in the FitzHugh-Nagumo model.}
        \label{fig:hRose_phase_portrait}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
    %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[t]{0.48\textwidth}
        \includegraphics[width=\textwidth]{hRose_bursting}
        \caption{Voltage oscillations against time. Voltage alternates between a high state and a low state when spiking. It then moves to a lower state while resting.}
        \label{fig:hRose_voltage_time}
    \end{subfigure}
\caption{Hindmarsh-Rose model for bursting.}
\label{fig:hRose_bursting}
\end{figure}

The difference between this model and the three time scale bursting normal form model is that the latter places all the nonlinearities in the dynamics of $x_f$. The Hindmarsh-Rose model mirrors the nullcline of $x_s$ by using a quadratic term, while the bursting normal form model mirrors the cubic nullcline using the bump nonlinearity. 

\begin{figure}[t]
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \includegraphics[width=\textwidth]{hRose_eqms1}
        \caption{The $x_{us}$ is just small enough that the nullclines interesect only once. The system will switch to spiking as this happens.}
        \label{fig:hRose_eqms1}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
    %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[t]{0.48\textwidth}
        \includegraphics[width=\textwidth]{hRose_eqms2}
        \caption{The $x_{us}$ is just large enough that the nullclines interesect thrice. The system will switch to resting as this happens.}
        \label{fig:hRose_eqms2}
    \end{subfigure}
\caption{Fast nullcline of Hindmarsh-Rose model being modulated by the ultra-slow variable ($x_{us}$). Stable equilibrium is the filled circle, unstable equilibrium is the hollow circle and the saddle point is the cross. Between this range of $x_{us}$, the system is bistable.}
\label{fig:hRose_changing_eqms}
\end{figure}

\begin{figure}[h!]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
\resizebox{9cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=0.75]
  
      % We start by placing the blocks
      \node [sum] at (0,3)(sum_outer){};
      \node [sum, right of = sum_outer,node distance = 2cm] (sum_inner) {};
      \node [input, above of = sum_inner, node distance = 1cm](I){};
      \node [block, right of = sum_inner, node distance=3cm] (high_gain) {\large{$\frac{1}{\epsilon s}$}};
      \node [output, right of = high_gain] (output) {};
      \node [block, below of = high_gain] (cubic_nullcline) {$f(\cdot)$};
      %\node [coordinate, below of]
      \node [input, below of = cubic_nullcline, node distance = 1.5cm](ultra_slow_const){};
      \node [sum, below of = ultra_slow_const, node distance = 0.5cm](ultra_slow_sum){};
      \node [block, below of = ultra_slow_const](bump){$g(\cdot)$};
      \node [block, left of = ultra_slow_sum, node distance = 2cm] (Hus){\large $H_{us}$};
      \node [block, left of = bump, node distance = 3.5cm](Hs){\large $H_s$};

      % Once the nodes are placed, connecting them is easy. 

      % inner loop
      \draw [draw,->] (sum_outer) -- node [pos = 0.9]{$+$} (sum_inner);
      \draw [->] (sum_inner) -- (high_gain);
      \draw [->] (high_gain) -- node [name=v] {$x_f$}(output);
      \draw [->] (v) |- (cubic_nullcline);
      \draw [->] (cubic_nullcline) -| node[pos=.85] {$+$} node [near end] {} (sum_inner);           	  \draw [->] (I) -- node[above,pos = -.05] {$I$}(sum_inner);
      

      % outer loop
           \draw [->] (ultra_slow_const) -- node[above,pos = -.05] {$\bar{x}_{us}$}(ultra_slow_sum);
      \draw [->] (v) |- node[above, pos = .9]{$+$}(ultra_slow_sum);
      \draw [->] (ultra_slow_sum) -- (Hus);      
      \draw [->] (Hus) -| node[anchor=south,pos=0.2] {$x_{us}$} node[pos=0.93]{-}(sum_outer);

	  % outermost loop
      \draw [->] (v) |- (bump);      
      \draw [->](bump)--(Hs);
      \draw [-](Hs)--(-1,-4.35);
      \draw [->](-1,-4.35)|- node[near start]{$x_s$} node[near end]{$+$}(sum_outer);
      %\draw [->] (I_app)-- node[near end]{$+$} (sum_outer);
  \end{tikzpicture}
  }
\caption{Hindmarsh-Rose model block diagram.}
\label{fig:hRose_block_diagram}
\end{figure}

\subsubsection{Separation of time scales to dissect into relay feedback systems}
The Hindmarsh-Rose model has the same key features as the three-time scale bursting normal form (compare the block diagrams in Figure \ref{fig:ttsbursting_circuit} and Figure \ref{fig:hRose_block_diagram}). The fast variable of the Hindmarsh-Rose model is like the output of a relay with shifting hysteresis limits (see Figure \ref{fig:hRose_phase_portrait}) as the ultra-slow variable adapts. Consequently, the fast positve feedback loop of the Hindmarsh-Rose model can be replaced by a skewed relay. 

 Regarding the slow positive-negative feedback, we need to examine Figure \ref{fig:hRose_bursting}. During spiking, the average of $x_f$ is positive and during resting, the average is negative. Since the slow plant is a low pass filter, we can assume that it only responds to the average of $x_f$. Consequently, similar to the `bump', for the fast-slow system, the quadratic nonlinearity, $g(x_f)$, provides negative feedback, when spiking and positive feedback when resting.

The ultra-slow negative feedback modulates the shape of the fast nullcline to change the equilibrium positions (see Figure \ref{fig:hRose_changing_eqms}) similar to the (unfolding) paramter $\alpha$ of the bursting model normal form. The utlra-slow negative feedback can be again viewed as responding only to the average of the fast oscillations. 

Following the same steps as described in the three time scale bursting normal form, the relay feedback model Hindmarsh-Rose model can be constructed. This reveals the capability of the relay feedback framework to addressing models of complex oscillations in literature. 


\FloatBarrier
\section{Conclusions}
The relay feedback framework's capability of modelling biological oscillations was explored. It was able to model the simple oscillations of the Goodwin and FitzHugh-Nagumo models. It was able to simplify a bursting normal form into two coupled relay feedback systems, enabling the Hindmarsh-Rose model to be caputered by relay feedback framework. The relay feedback methodology is appealing since it highlights the interconnection of analogue (L.T.I) systems with digital (relay) logic. Furthermore, it provided analytical tools using which predictions of time periods and stability can found for different parameters. This is a step towards answering the question from \cite{rinzel}: How robust is the bursting mechanism to parameter variations in the physiological range?  However, this framework fails to capture the excitatory nature of models. Relay feedback systems was able to capture the oscillatory part of the models. Future work in this area would perhaps involve modelling the next level of nested oscillations. Generalizing to an Nth level nested oscillation would provide a link to the theory of multirate feedback systems.


\section{Acknowledgements}
Prof.Rodolphe Sepulchre is gratefully acknowledged for supervising this project. His insight and guidance throughout the project was invalauable. Thiago Burghi is also gratefully acknowledged for his frequent support and discussions. 

\begin{thebibliography}{9}

%\bibitem{goldbeter} A.Goldbeter, (1995) \emph{A model for circadian oscillations in the Drosophila period protein (PER)}. Proc. R. Soc. Lond. B. Volume 261, Pages 319-324. 

\bibitem{fall}
C.P.Fall, E.S.Marland, J.M.Wagner, J.J.Tyson, \emph{Computational Cell Biology}. Springer. Volume 20. ISBN 0-387-95369-8. 

\bibitem{goldbeter1}
A.Goldbeter. (2002). \emph{Computational approaches to cellular rhythms.} Nature, Voluem 420, Pages 238-245.

\bibitem{goldbeter2}
A.Goldbeter and M.J.Berridge. (1996). \emph{Biochemical oscillations and cellular rhythms.} Cambridge University Press, ISBN 9780511608193. 

\bibitem{hang}
C.C.Hang, K.J.\r{A}str\"{o}m, Q.G.Wang, (2002) \emph{Relay feedback auto-tuning of process controllers --- a tutorial review.} Journal of Process Control, Volume 12, Pages 143-162. 

\bibitem{astrom1995}
K.J.\r{A}str\"{o}m , (1995) \emph{Oscillations in systems with relay feedback}. IMA Vol. Math. Appl. : Adap. Control, Filtering, Signal Processing, Volume 74, Pages 1-25. 

\bibitem{keener}
J.Keener and J.Sneyd, \emph{Mathematical Physiology}. Springer-Verlag New York. Volume 8/I. Second Edition. ISBN 978-0-387-75846-6. 

\bibitem{leloup}
J.C.Leloup and A.Goldbeter. (1998). \emph{A model for circadian rhythms in Drosophila incorporating the formation of a complex between PER and TIM proteins}. J.Biol.Rhythms, Volume 13, Pages 70-87. 

\bibitem{huxley}
A.Hodgkin and A.Huxley. (1952). \emph{A quantitative description of membrane current and its application to conduction and scitation in nerve.} J. Physiol, Volume 117, Pages 500-544.

\bibitem{fitzhugh}
R.FitzHugh. (1961). \emph{Impulses and physiological states in theoretical models of nerve membrane}. Biophysical Journal, Volume 1, Pages 445-466.

\bibitem{goodwin}
G.C.Goodwin, S.F.Graebe, M.E.Salgado, (2000). \emph{Control System Design}. Prentice Hall, ISBN 978-0-13-958653-8.

\bibitem{franci}
A.Franci and R.Sepulchre, (2014). \emph{Realization of nonlinear behaviours from organizing centers.} Proc. 53st. IEEE Conf. Decision Contr., Pages 56-61.

\bibitem{franci2}
A.Franci, G.Drion and R.Sepulchre, (2014). \emph{Modeling the modulation of neuronal bursting: a singularity theory approach.} SIAM Journal of Applied Dynamical Systems, Volume 13, Pages 798-829. 

\bibitem{rinzel}
J.Rinzel. (1986). \emph{A formal classification of bursting mechanisms in excitable systems.}, Proc. Int. Cong. Mathematicians, Berkeley, California, USA. 

\bibitem{drion}
G.Drion, T.O'Leary, J.Dethier, A.Franci and R.Sepulchre. (2015) \emph{Neuronal behaviors: a control perspective.} 54th IEEE Conference on Decision and Control, Osaka, Japan, Pages 1923-1944. Tutorial paper.

\bibitem{hindmarsh}
J.L.Hindmarhs and R.M.Rose, (1984). \emph{A model of neuronal bursting using three coupled first order fifferential euations}, Proc. R. Soc. Lond., Volume 221, Pages 87-102. 

\bibitem{kranc}
G.M.Kranc. (1957). \emph{Input-output analsis of multirate feedback systems.} IRE Transactions on Automatic Control, Volume 3, Pages 21-28. 

\end{thebibliography}

\newpage
\begin{appendices}
\appendixpage
\crefalias{section}{appsec}
\renewcommand{\thefigure}{A\arabic{figure}}
\setcounter{figure}{0}
\label{Appendix}
\section{Local stability relay model of Goodwin oscillator}
To check the local stability of the relay model of the Goodwin oscillator, we use Theorem 5.2 from \cite{astrom1995}. It requires that the eigenvalues of the $W$ matrix lies within the unit disc. The matrix is defined as:
\begin{equation}
W = \left(I - \frac{w_2C}{Cw_2}\right)\Phi_2\left(I - \frac{w_1C}{Cw_1}\right)\Phi_1
\end{equation}
where
\begin{align}
w_1 &= \Phi_1(Aa_1+Bd_1) \\
w_2 &= \Phi_2(Aa_2-Bd_2) \\
a_1 &= (I-\Phi)^{-1}(\Phi_2\Gamma_1d_1-\Gamma_2d_2)\\
a_2 &= (I-\Phi)^{-1}(-\Phi_1\Gamma_2d_2+\Gamma_1d_1)\\
\end{align}
and as defined in Section \ref{sec:asymm_oscillations}
\begin{equation}
\begin{array}{l}
\displaystyle \Phi = e^{AT}  \text{  ,  }\Phi_1 = e^{A\tau} \text{  ,  }  \Phi_2 = e^{A(T-\tau)} \\
\displaystyle \Phi_1 = \int_0^\tau e^{As}\text{d}sB \text{  ,  } \Gamma_2 = \int_0^{T-\tau}e^{As}\text{d}sB
\end{array}
\end{equation}

For our model, the oscillation is split such that $\tau = 0.19s $ and $T = 5.93s$. With $A,B,C$ defined by \ref{eq:goodwin_relay_state_space}, we get that:
\begin{equation}
W = 10^{-2}\begin{bmatrix}
-2.0 & -3.1 & -8.6 \\ -5.6 & -8.8& -24.2 \\ 0.0 & 0.0 & 0.0 \\
\end{bmatrix}
\end{equation}
$\text{  which has eigenvalues } -7.9\times10^{-6}, -1.1\times10^{-2} \text{ and } 0. $
Hence the limit cycle is locally stable. 
\newpage
\section{FitzHugh-Nagumo to standard relay feedback}\vspace{-.8cm}

\begin{figure}[h!]
\begin{subfigure}[t]{.4\textwidth}

\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
\resizebox{5cm}{!}{%
  % The block diagram code is probably more verbose than necessary
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=0.75]
      % We start by placing the blocks
      \node at (0,3) (I_app) {$I_{app}$};
      %\node[input, name = I_app]{text};
      \node[sum, right of = I_app](sum_outer){};
      \node [sum, right of = sum_outer] (sum_inner) {};
      \node [block, right of = sum_outer, node distance=3cm] (high_gain) {\large{$\frac{1}{\epsilon s}$}};
      % We draw an edge between the controller and system block to 
      % calculate the coordinate u. We need it to place the measurement block. 
      \node [output, right of = high_gain] (output) {};
      \node [block, below of = high_gain] (cubic_nullcline) {$f(\cdot)$};
      \node [block, below of = cubic_nullcline](linear_tf){\large $\frac{1}{s+\gamma}$};

      % Once the nodes are placed, connecting them is easy. 

      % inner loop
      \draw [draw,->] (sum_outer) -- node {$+$} (sum_inner);
      \draw [->] (sum_inner) -- node {$\dot{v}$} (high_gain);
      \draw [->] (high_gain) -- node [name=v] {$v$}(output);
      \draw [->] (v) |- (cubic_nullcline);
      \draw [->] (cubic_nullcline) -| node[pos=.85] {$+$} 
          node [near end] {} (sum_inner);

      % outer loop
      \draw [->](v) |- (linear_tf);
      \draw [->](linear_tf) -| node[anchor=south,pos=0.2] {$w$} 
          node[pos=0.93]{-}(sum_outer);
      \draw [->](I_app)-- node[near end]{$+$} (sum_outer);
  \end{tikzpicture}}
	\caption{Block diagram}%
	\label{fitz_nagumo_block_diagram}%
\end{subfigure}
\hspace{0.5cm}%
\begin{subfigure}[t]{.45\textwidth}
\centering
\begin{tikzpicture}[scale = 0.65]
  \begin{axis}[
    xmin=-.4,xmax=1.52,
    ymin=0.4,ymax=.72,
    axis lines=center,
    axis line style=->,
    xlabel={$v$},
    ylabel={$w$}
    ]
      \addplot[-] [color=red, style = thick] expression[domain=-0.45:1.2,samples=100]{-x^(3)+(1+0.1)*x^(2) - 0.1*x + 0.5}; 
      \addplot[-] [color=blue, style = thick] coordinates{(-.2693,0.6262) (.6883,.6262)};
            \addplot[<-] [color=blue, style = thick] coordinates{(.2693,0.6262) (.6883,.6262)};
            \addplot[<-] [color=blue, style = thick] coordinates{(.1993,0.6262) (.6883,.6262)};
      \addplot [color=blue, style = thick] coordinates{(.6883,0.6262) (1.003,.4976)};
      \addplot [color=blue, style = thick] coordinates{(-.2693,0.6262) (-.0061,.4976)};
      \addplot [-][color=blue, style = thick] coordinates{(-.0061,.4976) (1.003,.4976)};
      		\addplot [->][color=blue, style = thick] coordinates{(-.0061,.4976) (.6,.4976)};
            \addplot [->][color=blue, style = thick] coordinates{(-.0061,.4976) (.53,.4976)};
     % \addplot[-] [color=green, style = thick] expression[domain=-0.45:1.2,samples=100]{-y^(3)+(1+0.1)*y^(2) - 0.1*y + 0.5}; 
     \addlegendentry{$f(\cdot)$}
	 \addlegendentry{Relay approximation}
	\end{axis}
\end{tikzpicture}
	\caption{Nonlinearity and the ``relay" approximation}%
	\label{original_nonlinearity}%
\end{subfigure}
\caption{FitzHugh-Nagumo}
\label{fn}
\end{figure}

\vspace*{-.5cm}

\begin{figure}[h!]
\RawFloats
\centering
\begin{minipage}[t]{.45\textwidth}
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

% The block diagram code is probably more verbose than necessary
\resizebox{4cm}{!}{%
\begin{tikzpicture}[auto, node distance=2cm,>=latex, scale = 0.5]
    % We start by placing the blocks
    \node at (0,3) (I_app) {$I_{app}$};
    %\node[input, name = I_app]{text};
    \node[sum, right of = I_app](sum_outer){};
    \node [block, right of = sum_outer] (inverse) {$-f^{-1}(\cdot)$};
    \node [output, right of = inverse] (output) {};
    \node [block, below of = inverse](linear_tf){\large $\frac{1}{s+\gamma}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [->] (sum_outer) --(inverse);
    \draw [->] (inverse) -- node [name=v] {$v$}(output);
    \draw [->](v) |- (linear_tf);
    \draw [->](linear_tf) -| node[anchor=south,pos=0.2] {$w$} 
    	node[pos=0.93]{-}(sum_outer);
    \draw [->](I_app)-- node[near end]{$+$} (sum_outer);
\end{tikzpicture}
}
	\captionof{figure}{High gain inversion}%
	\label{high_gain_inversion}%
\end{minipage}
\hspace{.5cm}
\begin{minipage}[t]{.45\textwidth}
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
% The block diagram code is probably more verbose than necessary
\resizebox{4cm}{!}{%
\begin{tikzpicture}[auto, node distance=2cm,>=latex]
    % We start by placing the blocks
    \node at (0,3) (I_app) {$I_{app}$};
    %\node[input, name = I_app]{text};
    \node[sum, right of = I_app](sum_outer){};
    \node [block, right of = sum_outer] (inverse) {$f_{2}(\cdot)$};
    \node [output, right of = inverse] (output) {};
    \node [block, below of = inverse](linear_tf){\large $\frac{1}{s+\gamma}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [->] (sum_outer) --(inverse);
    \draw [->] (inverse) -- node [name=v] {$v$}(output);
    \draw [->](v) |- (linear_tf);
    \draw [->](linear_tf) -| node[anchor=south,pos=0.2] {$w$} 
    	node[pos=0.93]{+}(sum_outer);
    \draw [->](I_app)-- node[near end]{$-$} (sum_outer);
\end{tikzpicture}
}
      \captionof{figure}{$f_2(x) = -f^{-1}(-x)$}%
      \label{invert_y_axis}%
\end{minipage}
\end{figure}

\vspace{-1cm}

\begin{figure}[h!]
\begin{subfigure}[t]{0.45\textwidth}
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

% The block diagram code is probably more verbose than necessary
\resizebox{4cm}{!}{%
\begin{tikzpicture}[auto, node distance=2cm,>=latex]
    % We start by placing the blocks
	
    \node [block] (inverse) {$f_3(\cdot)$};
    \node [output, right of = inverse] (output) {};
    \node [input, left of = inverse](input){};
    \node [block, below of = inverse](linear_tf){\large $\frac{1}{s+\gamma}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [-] (inverse) -- (output);
    \draw [->] (output) |- node[near start] {$\hat{v}$}(linear_tf);
    \draw [-] (linear_tf) -| node[near end] {$\hat{w}$} (input);
    \draw [->] (input) -- (inverse);

\end{tikzpicture}
}
\caption{Block diagram}
\end{subfigure}
\quad%
\begin{subfigure}[t]{.45\textwidth}
\centering
\begin{tikzpicture}[xscale=3,yscale=1.5]
  \newcommand\myscale{1};
  \draw[->] (-1*\myscale,0) -- (0.1*\myscale,0) node[right] {$w$};
  \draw[->] (0,-1.5*\myscale*\myscale) -- (0,.5*\myscale*\myscale) node[above] {$v$};
    \draw[->] [green](-1*\myscale,-.354) -- (-.2*\myscale,-.354) node[right] {$\hat{w}$};
  	\draw[->] [green](-.5619,-1.5*\myscale*\myscale) -- (-.5619,.5*\myscale*\myscale) node[above] {$\hat{v}$};
    \draw[<->][magenta](-.5619,.3) -- node[above]{$\beta_2$} (0,.3);
    \draw[<->][magenta](-.8,-.354) -- node[left]{$\beta_1$} (-.8,0);

% code for Mirror Image
\begin{scope}[xscale = -1,xshift=0cm]
  \begin{scope}[yscale=-1,yshift=0cm]
    \draw[scale=\myscale,domain=-.45:1.2,smooth,variable=\y,red, thick]  plot ({-(\y)^(3)+(1+0.1)*(\y)^(2) - 0.1*(\y) + 0.5},{\y});
    \draw[-,scale=\myscale,blue] (0.6262,-.2693) -- (0.6262,.6883);
    \draw[-,scale=\myscale,blue] (0.6262,.6883) -- (.4976,1.003);
    \draw[-,scale=\myscale,blue] (0.6262,-.2693) -- (.4976,-.0061);
    \draw[-,scale=\myscale,blue] (.4976,-.0061) -- (.4976,1.003);
  \end{scope}
  \end{scope}
\end{tikzpicture}
\caption{Nonlinearity in new co-ordinates, $f_3(\cdot)$}
\end{subfigure}
      \caption{Shift co-ordinate system to make relay symmetric, $I_{app}$ disappears. $\hat{w} = w + \beta_2$ and $\hat{v} = v + \beta_1$}%
      \label{shift1}%
\end{figure}\nopagebreak%
\begin{figure}[h!]
\RawFloats
\centering
\begin{minipage}[t]{.4\textwidth}
\begin{tikzpicture}[auto, node distance=2cm,>=latex]
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]   % We start by placing the blocks

\def\relay{
\tikz[remember picture,overlay]{
\draw[->] (-.8,0) -- (.8,0);
\draw[->] (0,-0.45)--(0,0.45);
\draw[blue] (0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(-.7,.2);
\draw[blue] (-.2,.2)--(-.2,-.2)--(.2,-.2);
}}

    \node [block] (inverse) {};
    \node[] at (inverse) {\relay};
    \node [output, right of = inverse] (output) {};
    \node [input, left of = inverse](input){};
    \node [block, below of = inverse](linear_tf){\large $\frac{1}{s+\gamma-\xi}$};

    % Once the nodes are placed, connecting them is easy. 
    \draw [-] (inverse) -- (output);
    \draw [->] (output) |- node[near start] {$u$}(linear_tf);
    \draw [-] (linear_tf) -| node[near end] {$y$} (input);
    \draw [->] (input) -- (inverse);

\end{tikzpicture}
\captionof{figure}{Change of basis to use relay. $\hat{w}=y$ and $\hat{v} = \xi y + u$}
\label{fn_final_block}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}[t]{.4\textwidth}\vspace{-2cm}\small
Following the steps from the Figures \ref{fn} to \ref{fn_final_block} allow the standard relay to be used to model the FitzHugh-Nagumo equations. The original variables can be recovered as: 
\begin{equation*}
\begin{cases}
v = \hat{v}-\beta_1 = \xi y + u - \beta_1 \\
w = \hat{w}-\beta_2 = y - \beta_2 \\
\end{cases}
\end{equation*}
\end{minipage}
\end{figure}


\newpage
The first step in replacing the cubic nullcline was to approximate it using a skewed relay. This involved selecting four points on the nullcline that represented the essential behaviour. The points chosen were: 
\begin{equation}
(-0.2693,0.6262),(0.6883,0.6262),(-0.0061,0.4976),(1.003,0.4976)
\end{equation}
These points now represent the nonlinear function $f(v)$. They undergo the transformations described in the above figures in order to convert them to a standard relay feedback system. To inverse the $f(v)$, each point was reflected about the $y=x$ line. Then they were reflected about the x-axis in order to swap the signs of the input signals. Next, they were reflected in the y-axis due to the minus sign. To centralise the relay about the origin, they points were shifted by $(\beta_2,\beta_1) = (-0.562,-0.354)$. $\xi$ was then chosen in order to get a standard relay --- multiply each point by the matrix S,:
\begin{equation}
S = \begin{bmatrix}
1 & 0 \\ -\xi & 1 
\end{bmatrix}  = \begin{bmatrix}
1 & 0 \\ 2 & 1 
\end{bmatrix}
\end{equation}  

This resulted in the four points being positioned at:
\begin{equation}
(0.0643,0.4917),(0.0643,-0.4917),(-0.0643,0.4917),(-0.0643,-0.4917)
\end{equation}

The skew matrix can be understood by considering the skewed relay as simply a relay with an extra loop as shown below. The equations show where the skew matrix comes from. Lumping the extra loop with the original plant gives the new system. 

\begin{figure}[h!]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
\def\relay{
\tikz[remember picture,overlay]{
\draw[->] (-.8,0) -- (.8,0);
\draw[->] (0,-0.45)--(0,0.45);
\draw[blue] (0.7,-0.2)--(0.2,-0.2)--(0.2,0.2)--(-.7,.2);
\draw[blue] (-.2,.2)--(-.2,-.2)--(.2,-.2);
}}
\resizebox{7cm}{!}{%
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=0.75]
  
      % We start by placing the blocks
      \node [block] at (0,3) (plant) {$G(s)$};
      \node [coordinate, right of = plant](out){};
      \node [gain, below of = plant](skew){$\xi$};
      \node [block, below of = skew](relay){};
      \node [] at (relay) {\relay};
      \node [sum, left of = relay, node distance = 2cm](sum){};
      \node [coordinate, left of = sum,node distance = 1cm](out2){};
      
      % Once the nodes are placed, connecting them is easy. 

      % inner loop
      \draw [-] (plant) -- (out){};
      \draw [->] (out)|- node[right,near start]{$i$} 
      node[near end,name = i2]{} (relay);
      \draw [->] (relay) -- node[below, pos=.5,name =v]{$v'$} 
      	node[above,pos = .9]{$+$} (sum);
      \draw [-] (sum) -- (out2);
      \draw [->] (out2)|- node[left, near start]{$v$} (plant);     
      \draw [->] (skew)-| (sum);
      \draw [->] (i2)|-(skew);

  \end{tikzpicture}
  }

\caption{Skewed relay}
\end{figure}

\begin{align}
i &= G(s)v \\
v &= \xi i + v' \\
\text{we want $i$ in terms of $v'$}\\
i &= G(s)(\xi i + v') \\
i &= \left(\frac{G(s)}{1-\xi G(s)}\right)v'\\
G(s) &= \frac{1}{s + \gamma}\\
\Rightarrow i(s) &= \left(\frac{1}{s+\gamma-\xi}\right)v'(s)
\end{align}

This is a standard relay with hysteresis limits $\epsilon = 0.0643$ and output $d = 0.4917$. The state-space representation of this system was thus:
\begin{align}
\dot{x} &= (\gamma-\xi)x + u = 2.5x + u \\
y &= x \\
u &= \begin{cases}
	               -0.4917 \text{ if } e > 0.0643 \text{ or } (e >-0.0643 \text{ and } u(t-) = 0.4917)\\
	                0.4917 \text{ if } e < -0.0643 \text{ or } (e < 0.0643 \text{ and } u(t-) = -0.4917)	              
	            \end{cases}
\end{align}

The original system is then recovered by:
\begin{align}
v&= \xi y + u - \beta_1 = -2y+u+0.354 \\
w&= y - \beta_2 = y + 0.562 
\end{align}

Using equation \ref{eq:2_3}, the time period was predicted to be 0.54 seconds. The local stability was tested using Theorem 3.1 of \cite{astrom1995}, with the $W$ matrix being equal to zero and hence having eigenvalues within the unit disk. 

\section{Three time scale burster}

In order to find the bistable range for the piece-wise linear model of the system, it requires us to find the two critical points at which the system changes from having only one equilibrium to two equilibriums. This was shown for the original model in Figure \ref{fig:ttsbursting_bistable_range}. 

\begin{figure}[h!]
\includegraphics[width = 0.6\textwidth]{tts_bistable_range}
\caption{The bistable range for the $\alpha$ parameter.}
\end{figure}

The fast nullcline can be written as:
\begin{equation}
G(x_f, x_s, \alpha) = - x_f + \text{sign}\left(B\left(u+x_s + \tfrac{1}{2}\gamma x_f\right) + \beta x_f + \alpha \right)
\end{equation}
The extreme point of the lower branches are right when the sign $(\cdot)$ function changes from being 1 to $-1$. Since $x_f = -1$, this means: $B(u + x_s -\tfrac{1}{2}\gamma) -\beta + \alpha = 0$. This can be written as:
\begin{align}
\tfrac{1}{2}(u + x_s -\tfrac{1}{2}\gamma) - \beta + \alpha &= 0 \text{\hspace{2cm} if } -2< (u +  x_s -\tfrac{1}{2}\gamma)<0 \\
-\tfrac{1}{2}(u + x_s -\tfrac{1}{2}\gamma) - \beta + \alpha &= 0 \text{\hspace{2cm} if } 0< (u +  x_s -\tfrac{1}{2}\gamma)<2 \\
\end{align}
We are first concerned at which point the linear nullcline intersects the lower left hand branch of the fast nullcline. At that point, $x_f = -1$. This implies that $x_s = -1$  as well. This means:

\begin{equation}
\alpha_{max} = \beta + \tfrac{1}{2}(u-1-\tfrac{1}{2}\gamma)
\end{equation}

The two extreme points of the lower branch meet when we reach the peak of the bump, i.e $u + x_s - \tfrac{1}{2}\gamma = 0$. Thus:
\begin{equation}
\alpha_{min} = \beta
\end{equation}

\begin{figure}[h!]
\centering
\tikzstyle{block} = [draw,  rectangle,  minimum height=3em, minimum width=6em]
\tikzstyle{gain} = [draw, regular polygon, regular polygon sides = 3, regular polygon rotate = 90, minimum height = 2em, minimum width = 2em]
\tikzstyle{sum} = [draw,  circle, node distance=1cm, line width = 0.5mm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]
\resizebox{10cm}{!}{%
  \begin{tikzpicture}[auto, node distance=2cm,>=latex,scale=2]
  
      % We start by placing the blocks
      \node [sum,PineGreen] at (-1,-1) (xf1) {};
      \node [sum,Plum] at (-.5,-1) (xf2) {};
      \node [sum,MidnightBlue] at (-2.3,1) (xf3) {};
      \node [sum,MidnightBlue] at (0.8,1) (xf4) {};
      
      
      % Once the nodes are placed, connecting them is easy. 
	  \draw [->] (0,-2) -- node [above, pos = 1]{$x_f$}(0,2);
	  \draw [->] (-3,0) -- node [right, pos = 1 ]{$x_s$}(2,0);
      \draw [-,PineGreen,line width = 0.5mm] (-3,-1) -- node[below]{$-2<u+x_s-\tfrac{1}{2}\gamma$}(xf1){};
      \draw [-,MidnightBlue,line width = 0.5mm] (xf3) -- node[above]{$x_f = 1$}(xf4){};
      \draw [-,Plum,line width = 0.5mm] (xf2) -- node[above]{$0<u+x_s-\tfrac{1}{2}\gamma$} (2,-1){};
 	  \draw [dotted,blue,line width = 0.5mm] (xf1) -- (xf3);
 	  \draw [dotted,blue,line width = 0.5mm] (xf2) -- (xf4);


  \end{tikzpicture}
  }
\caption{Fast nullcline branches.}
\end{figure}

\section{Risk assessment retrospective}
This project was research oriented and involved using MATLAB and Simulink in order to simulate different models. The only risks were those associated with working on a computer for extended periods of time. This was as expected at the onset of the project. Taking regular breaks and good posture helped to reduce the risks.

\end{appendices}

\end{document}
